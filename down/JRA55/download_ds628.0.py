#!/usr/bin/env python
#################################################################
# Python Script to retrieve 140 online Data files of 'ds628.0',
# total 219.27G. This script uses 'requests' to download data.
#
# Highlight this script by Select All, Copy and Paste it into a file;
# make the file executable and run it on command line.
#
# You need pass in your password as a parameter to execute
# this script; or you can set an environment variable RDAPSWD
# if your Operating System supports it.
#
# Contact rdahelp@ucar.edu (RDA help desk) for further assistance.
#################################################################


import sys, os
import requests

def check_file_status(filepath):
    sys.stdout.write('\r')
    sys.stdout.flush()
    size_mb = int(os.stat(filepath).st_size)/ 1000**2
    sys.stdout.write('Downloaded %.1f MB' % (size_mb,))
    sys.stdout.flush()

dspath = 'https://request.rda.ucar.edu/dsrqst/SUN726738/'
filelist = [
'TarFiles/anl_p25.007_hgt.1958010100_1958013118-1960110100_1960113018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1977110100_1977113018-1980090100_1980093018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1997090100_1997093018-2000070100_2000073118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2017070100_2017073118-2020050100_2020053118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1971040100_1971043018-1974020100_1974022818.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1991020100_1991022818-1993120100_1993123118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2010120100_2010123118-2013100100_2013103118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1964090100_1964093018-1967070100_1967073118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1984070100_1984073118-1987050100_1987053118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2004050100_2004053118-2007030100_2007033118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1958020100_1958022818-1960120100_1960123118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1977120100_1977123118-1980100100_1980103118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1997100100_1997103118-2000080100_2000083118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2017080100_2017083118-2020060100_2020063018.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1971050100_1971053118-1974030100_1974033118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1991030100_1991033118-1994010100_1994013118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2011010100_2011013118-2013110100_2013113018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1964100100_1964103118-1967080100_1967083118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1984080100_1984083118-1987060100_1987063018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2004060100_2004063018-2007040100_2007043018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1960120100_1960123118-1963100100_1963103118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1980100100_1980103118-1983080100_1983083118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2000080100_2000083118-2003060100_2003063018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2020060100_2020063018-2023040100_2023043018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1974030100_1974033118-1977010100_1977013118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1994010100_1994013118-1996110100_1996113018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2013110100_2013113018-2016090100_2016093018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1967080100_1967083118-1970060100_1970063018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1987060100_1987063018-1990040100_1990043018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2007040100_2007043018-2010020100_2010022818.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1961010100_1961013118-1963110100_1963113018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1980110100_1980113018-1983090100_1983093018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2000090100_2000093018-2003070100_2003073118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2020070100_2020073118-2023050100_2023053118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1974040100_1974043018-1977020100_1977022818.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1994020100_1994022818-1996120100_1996123118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2013120100_2013123118-2016100100_2016103118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1967090100_1967093018-1970070100_1970073118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1987070100_1987073118-1990050100_1990053118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2007050100_2007053118-2010030100_2010033118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1963110100_1963113018-1966090100_1966093018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1983090100_1983093018-1986070100_1986073118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2003070100_2003073118-2006050100_2006053118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2023050100_2023053118-25.011_tmp.1960020100_1960022918.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1977020100_1977022818-1979120100_1979123118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1996120100_1996123118-1999100100_1999103118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2016100100_2016103118-2019080100_2019083118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1970070100_1970073118-1973050100_1973053118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1990050100_1990053118-1993030100_1993033118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2010030100_2010033118-2013010100_2013013118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1963120100_1963123118-1966100100_1966103118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1983100100_1983103118-1986080100_1986083118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2003080100_2003083118-2006060100_2006063018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2023060100_2023063018-25.039_vvel.1960030100_1960033118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1977030100_1977033118-1980010100_1980013118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1997010100_1997013118-1999110100_1999113018.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2016110100_2016113018-2019090100_2019093018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1970080100_1970083118-1973060100_1973063018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1990060100_1990063018-1993040100_1993043018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2010040100_2010043018-2013020100_2013022818.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1966100100_1966103118-1969080100_1969083118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1986080100_1986083118-1989060100_1989063018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2006060100_2006063018-2009040100_2009043018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1960030100_1960033118-1963010100_1963013118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1980010100_1980013118-1982110100_1982113018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1999110100_1999113018-2002090100_2002093018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2019090100_2019093018-2022070100_2022073118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1973060100_1973063018-1976040100_1976043018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1993040100_1993043018-1996020100_1996022918.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2013020100_2013022818-2015120100_2015123118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1966110100_1966113018-1969090100_1969093018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1986090100_1986093018-1989070100_1989073118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2006070100_2006073118-2009050100_2009053118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1960040100_1960043018-1963020100_1963022818.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1980020100_1980022918-1982120100_1982123118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1999120100_1999123118-2002100100_2002103118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2019100100_2019103118-2022080100_2022083118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1973070100_1973073118-1976050100_1976053118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1993050100_1993053118-1996030100_1996033118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2013030100_2013033118-2016010100_2016013118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1969090100_1969093018-1972070100_1972073118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1989070100_1989073118-1992050100_1992053118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2009050100_2009053118-2012030100_2012033118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1963020100_1963022818-1965120100_1965123118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1982120100_1982123118-1985100100_1985103118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2002100100_2002103118-2005080100_2005083118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2022080100_20220853118-25.033_ugrd.1959050100_19590553118.sun726738.n.tar',
'TarFiles/anl_p25.033_ugrd.1976050100_1976053118-1979030100_1979033118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1996030100_1996033118-1999010100_1999013118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2016010100_2016013118-2018110100_2018113018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1969100100_1969103118-1972080100_1972083118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1989080100_1989083118-1992060100_1992063018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2009060100_2009063018-2012040100_2012043018.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1963030100_1963033118-1966010100_1966013118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1983010100_1983013118-1985110100_1985113018.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2002110100_2002113018-2005090100_2005093018.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2022090100_20220918-25.052_rh.1959060100_19590618.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1976060100_1976063018-1979040100_1979043018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1996040100_1996043018-1999020100_1999022818.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2016020100_2016022918-2018120100_2018123118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1972080100_1972083118-1975060100_1975063018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1992060100_1992063018-1995040100_1995043018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2012040100_2012043018-2015020100_2015022818.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1966010100_1966013118-1968110100_1968113018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1985110100_1985113018-1988090100_1988093018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2005090100_2005093018-2008070100_2008073118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1959060100_1959063018-1962040100_1962043018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1979040100_1979043018-1982020100_1982022818.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1999020100_1999022818-2001120100_2001123118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2018120100_2018123118-2021100100_2021103118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1972090100_1972093018-1975070100_1975073118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1992070100_1992073118-1995050100_1995053118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2012050100_2012053118-2015030100_2015033118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1966020100_1966022818-1968120100_1968123118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1985120100_1985123118-1988100100_1988103118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2005100100_2005103118-2008080100_2008083118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1959070100_1959073118-1962050100_1962053118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1979050100_1979053118-1982030100_1982033118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1999030100_1999033118-2002010100_2002013118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2019010100_2019013118-2021110100_2021113018.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1975070100_1975073118-1977100100_1977103118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.1995050100_1995053118-1997080100_1997083118.sun726738.nc.tar',
'TarFiles/anl_p25.007_hgt.2015030100_2015033118-2017060100_2017063018.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1968120100_1968123118-1971030100_1971033118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.1988100100_1988103118-1991010100_1991013118.sun726738.nc.tar',
'TarFiles/anl_p25.011_tmp.2008080100_2008083118-2010110100_2010113018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1962050100_1962053118-1964080100_1964083118.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.1982030100_1982033118-1984060100_1984063018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2002010100_2002013118-2004040100_2004043018.sun726738.nc.tar',
'TarFiles/anl_p25.033_ugrd.2021110100_2021113018-25.034_vgrd.1958010100_1958013118.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1975080100_1975083118-1977110100_1977113018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.1995060100_1995063018-1997090100_1997093018.sun726738.nc.tar',
'TarFiles/anl_p25.034_vgrd.2015040100_2015043018-2017070100_2017073118.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1969010100_1969013118-1971040100_1971043018.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.1988110100_1988113018-1991020100_1991022818.sun726738.nc.tar',
'TarFiles/anl_p25.039_vvel.2008090100_2008093018-2010120100_2010123118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1962060100_1962063018-1964090100_1964093018.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.1982040100_1982043018-1984070100_1984073118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2002020100_2002022818-2004050100_2004053118.sun726738.nc.tar',
'TarFiles/anl_p25.052_rh.2021120100_2021123118-2024010100_2024013118.sun726738.nc.tar']
for file in filelist:
    filename=dspath+file
    file_base = os.path.basename(file)
    print('Downloading',file_base)
    req = requests.get(filename, allow_redirects=True, stream=True)
    with open(file_base, 'wb') as outfile:
        chunk_size=1048576
        for chunk in req.iter_content(chunk_size=chunk_size):
            outfile.write(chunk)
            check_file_status(file_base)
    print()
